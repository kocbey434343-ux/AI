# MAJOR CR KAYITLARI

| CR-ID | Açıklama | Durum | Versiyon | Dosyalar | Notlar |
|-------|----------|-------|----------|----------|--------|
| CR-0090 | P1 Production Issue Resolution | done | 0001 | .env, src/api/binance_api.py, data/testnet/ | MAJOR P1 PRODUCTION ACHIEVEMENT: Bot trade yapmama ve pozisyon görünmeme sorunu tamamen çözüldü. Root causes: MARKET_MODE=spot but futures keys, OFFLINE_MODE auto-detection, 63 fake trades. Solutions: Environment reconfiguration, v2 API integration, mock data cleanup, real position reconciliation. Result: Real testnet operational |
| CR-0089 | Testnet v2 API Integration | done | 0001 | src/api/binance_api.py, .env | CRITICAL BREAKTHROUGH: Binance Futures v2 endpoint tam entegrasyonu. MARKET_MODE=futures configuration, real testnet API keys integration, /fapi/v2/positionRisk endpoint active utilization, 578 positions detected successfully, OFFLINE_MODE -> ONLINE_MODE transition achieved |
| CR-0088 | Mock Data Cleanup | done | 0001 | data/testnet/trades.db | SPECTACULAR CLEANUP: 63 fake/dummy trade cleaned from testnet database. Removed ATRTEST*, TEST* symbols, production-ready clean state achieved. Real BTCUSDT position properly integrated via reconciliation. Database state: 1 open trade (real), 0 closed trades, 0 mock data |
| CR-P1-UI-PERSONALIZATION-COMPLETION | P1 UI Personalization Complete | done | 0001 | src/ui/main_window.py | MAJOR P1 UI ACHIEVEMENT: Comprehensive personal configuration UI optimization complete! All UI components fully adapted to personal trading settings: Signal thresholds (BUY 30-80 default 45, SELL 10-40 default 20), Risk management (0.1-2.0% default 0.75%, 1-5 positions default 2), Trading parameters (Stop loss 0.5-5.0%, Take profit 2.0-15.0%, Leverage 1-10x conservative, ATR 1.2-3.0), Technical analysis (RSI 10-25, BB 15-30, MACD 8-18/20-35/7-15), Performance settings (UI 2-15s, Data 30-300s, INFO-first log), Quality filters (Market cap 50-500M default 100M, 24h change 5-25% default 15%, Volatility 1.5-4.0 default 2.5), Market data (1h-first interval, 14-90 days default 30, 3-6 precision default 4), Personal banner with conservative trading focus. Complete UI personalization for enhanced individual trading experience achieved |
| CR-P1-PERSONAL-CONFIGURATION-COMPLETION | P1 Personal Configuration Optimization Complete | done | 0001 | config/settings.py | MAJOR P1 ACHIEVEMENT: Comprehensive 6-category optimization for individual trading use. Performance: TOP_PAIRS_COUNT 150→50, ANALYSIS_PAIRS_LIMIT 3→5, WS_SYMBOL_LIMIT 40→25, CALIB_PARALLEL_WORKERS 4→2. Risk: DEFAULT_RISK_PERCENT 1.0%→0.75%, DEFAULT_MAX_POSITIONS 3→2, MAX_DAILY_LOSS_PCT 3.0%→2.0%, MAX_CONSECUTIVE_LOSSES 4→3. Signals: BUY_SIGNAL_THRESHOLD 50→45, SELL_SIGNAL_THRESHOLD 17→20, optimized thresholds. Features: SMART_EXECUTION=false, META_ROUTER=false, A32_EDGE_HARDENING=false verified disabled. WebSocket & Backtest: bandwidth reduction, resource-friendly for personal use. Validation: 676 tests PASSED (99.85% success rate) |
| CR-P3-CODE-QUALITY-COMPLETION | P3 Code Quality Improvements Complete | done | 0001 | src/ui/signal_window.py, src/headless_runner.py, tests/ | MAJOR P3 ACHIEVEMENT: Static analysis cleanup (1363→1173 warnings, 209 auto-fixes), magic numbers refactoring (SIGNAL_SCORE_HIGH_THRESHOLD=80, SIGNAL_SCORE_LOW_THRESHOLD=40), test stabilization (headless runner offline mode, VWAP execution simplification), 676 PASSED 1 SKIPPED 0 FAILED (99.85% success rate) |
| CR-A35-PHASE1-COMPLETION | A35 Phase 1 Production Readiness | done | 0001 | src/trader/trailing.py, src/trader/execution.py, tests/ | SPECTACULAR SUCCESS: 13 critical failures → 676 PASSED (99.85% success rate). Context Manager Protocol BREAKTHROUGH: Fixed 'NoneType' object context manager protocol errors. Protection cleared field enhancement with idempotency. Production deployment ready status achieved |
| CR-TRADESTORE-API-METHOD-MISMATCH-FIX | TradeStore API Method Mismatch Fix | done | 0001 | src/ui/main_window.py | Performance dashboard'taki "API Yok" hatası çözüldü. UI fonksiyonları yanlış TradeStore metodlarını çağırıyordu: `get_closed_trades()` → `closed_trades(limit=N)`, `get_open_positions()` → `open_trades()`. DataFrame tabanlı kod List tabanlı kod ile değiştirildi, tüm data calculation fonksiyonları güncellendi |
| CR-EMERGENCY-STOP-METHOD-NAME-FIX | Emergency Stop Method Name Fix | done | 0001 | src/ui/main_window.py | Emergency stop butonundaki "emergency_shutdown" method not found hatası düzeltildi. `trader.emergency_shutdown()` yerine mevcut `trader.close_all_positions()` metoduna geçildi, fallback olarak `trader.stop()` eklendi |
| CR-BOT-CONTROL-PERFORMANCE-DASHBOARD-FIX | Bot Control Performance Dashboard Fix | done | 0001 | src/ui/main_window.py | Performans özeti bölümündeki grid layout overlap sorunları düzeltildi (label ve değerler aynı column'a eklenmişti), değerler column 3'e taşındı. Tüm data calculation fonksiyonlarında defensive programming: trader/trade_store None kontrolü, DataFrame column kontrolü, type-safe conversion, enhanced exception handling. `_calculate_daily_pnl`, `_count_active_positions`, `_get_last_trade_time`, `_check_api_status`, `_calculate_max_drawdown` güvenli hale getirildi |
| CR-BOT-STATUS-SYNC-FIX | Bot Status Display Synchronization Fix | done | 0001 | src/ui/main_window.py | Bot kontrol tabında "Detaylı Durum" butonu ile bot başlatma durumu arasındaki tutarsızlık çözüldü. `_show_bot_status` `self._bot_core` kontrol ediyordu ama bot başlatma `self.trader` kullanıyordu. `_start_bot()` artık `self._bot_core = self.trader` ile sync ediyor, `_stop_bot()` `self._bot_core = None` ile temizliyor, `__init__()` da doğru initialize ediyor |
| CR-SCALP-MODE-SETTINGS-INTEGRATION | Scalp Mode Settings Class Integration | done | 0001 | config/settings.py, src/ui/main_window.py | Scalp mode ayarları Settings class'ına taşındı, duplicate tanımlar kaldırıldı, "Settings has no attribute SCALP_RISK_PERCENT" hatası çözüldü, trading mode switching operational |
| CR-EMERGENCY-STOP-DUAL-IMPLEMENTATION | Emergency Stop Button Dual Implementation | done | 0001 | src/ui/main_window.py | ACİL KAPAT butonu hem ana sayfa pozisyonlar bölümünde hem de Bot Control tabında eklendi, emergency_stop_btn_control instance oluşturuldu, comprehensive emergency shutdown functionality |
| CR-0085 | Endpoint Switch Safety | done | 0001 | src/api/binance_api.py,tests/test_cr0085_endpoint_safety.py | Varsayılan testnet; prod için ALLOW_PROD=true zorunluluğu; üç unit test ile block/allow/default doğrulandı |
| CR-API-V2-MIGRATION | Binance API V2 Endpoint Migration | done | 0001 | src/api/binance_api.py | python-binance deprecated /fapi/v1/positionRisk endpoint migration to /fapi/v2/positionRisk. Monkey patch implementation with _patch_client_for_v2_endpoints(), automatic V2 switching + V1 fallback, manual _signed_request_v2() for modern Binance Futures API v2 support |
| CR-0087 | Executions Dedup Persistence | done | 0001 | src/utils/trade_store.py,tests/test_executions_dedup_persistence.py | executions.dedup_key alanı + UNIQUE index (idx_exec_dedup); IntegrityError ile idempotent insert; legacy DB'lere idempotent migration helper |
| CR-UI-BOT-CONTROL-RISK-SPINBOX-FIX | UI Bot Control Risk Spinbox Fix | done | 0001 | src/ui/main_window.py | MainWindow'da duplicate risk_spinbox tanımları düzeltildi - Bot Control tab'ında risk ayarları grubu eklendi, "MainWindow' object has no attribute 'risk_spinbox'" hatası çözüldü. Deprecated unified interface kodları temizlendi, sadece _build_ui() metodu kullanılıyor |
| CR-BOT-CONTROL-FOUNDATION | Bot Control Center Foundation | done | 0001 | src/ui/main_window.py | Modern bot control center UI tab creation, menu cleanup, basic controls (start/stop/status), risk settings (risk%, max positions), real-time status display, UI integration complete |
| CR-BOT-CONTROL-TELEMETRY | Real-time Telemetry Integration | done | 0001 | src/ui/main_window.py | Real-time bot metrics (uptime, PnL, success rate, active positions), telemetry threading, performance monitoring, risk escalation status display, 2-second update cycle |
| CR-BOT-CONTROL-SETTINGS | Advanced Settings Management | done | 0001 | src/ui/main_window.py, config/settings.py | Strategy switcher (A30/A31/A32), Meta-Router toggle, Edge Health settings, HTF/Time Stop/Spread Guard/Kelly Fraction toggles, hot-reload configuration, advanced risk parameters, comprehensive settings UI |
| CR-BOT-CONTROL-DASHBOARD | Performance Dashboard | done | 0001 | src/ui/main_window.py | Performance mini dashboard: günlük PnL, aktif pozisyon sayısı, risk seviyesi, son işlem zamanı, API durumu, max drawdown real-time metrics, advanced telemetry integration, color-coded status indicators |
| CR-BOT-CONTROL-AUTOMATION | Scheduler & Automation | done | 0001 | src/utils/scheduler.py, src/ui/main_window.py | BotScheduler engine, time-based bot scheduling, market hours automation, maintenance windows, auto risk reduction, scheduled tasks, daily schedule management, UI automation panel, comprehensive task management |
| CR-A31-META-ROUTER | A31 Meta-Router & Ensemble System | done | 0001 | src/strategy/ (specialist_interface.py, meta_router.py, trend_pb_bo.py, range_mr.py, vol_breakout.py, xsect_momentum.py, __init__.py), test_a31_integration.py | 4 uzman stratejisi (S1: Trend PB/BO, S2: Range MR, S3: Vol Breakout, S4: XSect Momentum), MWU ağırlık öğrenme, gating sistem, ensemble sinyal üretimi, specialist interface pattern, registry yönetimi, integration test PASS |
| CR-A32-EDGE-HARDENING | A32 Edge Hardening System | done | 0001 | src/utils/ (edge_health.py, cost_calculator.py, microstructure.py), tests/test_a32_integration.py | Edge Health Monitor (Wilson CI + 200 trade window), 4× Cost-of-Edge calculator, OBI/AFR mikroyapı filtreleri, comprehensive testing framework, 9/9 integration tests PASS |
| CR-A32-PROD-INTEGRATION | A32 Production Integration | done | 0001 | src/trader/core.py, src/signal_generator.py, config/settings.py | A32 Edge Hardening sistemini production trade flow'una entegre edildi: pre-trade 4× cost kuralı, edge health monitoring, OBI/AFR microstructure filtreleri, SignalGenerator pipeline integration, Trader Core initialization, comprehensive configuration parameters |
| CR-ADVANCED-ML-PIPELINE | Advanced ML Pipeline Framework | done | 0001 | src/ml/advanced_ml_pipeline.py, tests/test_advanced_ml_pipeline.py | Next-generation ML system: AdvancedFeatureEngineer (50+ features: multi-timeframe technical, volatility regimes, cross-asset correlation, microstructure OBI/AFR, calendar seasonality), AdvancedMLPipeline (XGBoost/LightGBM/RF ensemble models, direction/volatility/returns prediction, real-time inference <100ms), sophisticated feature caching, model drift detection, A/B testing framework, 874 lines production-ready implementation |
| A30-HTF-FILTER | HTF EMA(200, 4h) Filter Implementation | done | 0001 | src/signal_generator.py,config/settings.py,tests/test_htf_filter.py | HTF EMA(200) trend bias filtresi, deterministik hesaplama, Settings cache fix, test stabilizasyonu |
| A30-TIME-STOP | Position Time Stop (24 bars) | done | 0001 | src/trader/core.py,config/settings.py | Pozisyon yaş limiti kontrolü, TIME_STOP_ENABLED/TIME_STOP_BARS parametreleri, structured logging |
| A30-SPREAD-GUARD | Spread Guard Protection (10 BPS) | done | 0001 | src/trader/execution.py,src/api/binance_api.py,config/settings.py | Bid/ask spread koruması, SPREAD_GUARD_ENABLED/SPREAD_MAX_BPS, graceful fallback, ticker desteği |

## CR-0053 - CR-0087 Detaylı Kayıtlar

| CR-0053 | Inventory Cross-Ref Validation | done | 0001 | generate_inventory.py | missing/extra raporu |
| CR-0054 | Hysteresis Band Refactor & Test | done | 0001 | signal_generator.py,test_hysteresis_logic.py | deterministik AL/BEKLE/SAT akışı |
| CR-0055 | Deterministic Stale Detection | done | 0001 | data_fetcher.py | path senkron & union kaldırma |
| CR-0056 | Scale-out Reload Fix | done | 0001 | core.py | scaled_out_json tam parse |
| CR-0057 | Test Isolation DB Strategy | done | 0001 | core.py | PYTEST_CURRENT_TEST izolasyon DB |
| CR-0058 | Partial Exit Fallback Persist | done | 0001 | trailing.py | scale_out JSON fallback |
| CR-0059 | Stale Test Deterministic Injection | done | 0001 | data_fetcher.py | test sembol garantisi |
| CR-0060 | Partial Exit Idempotency Guard | done | 0001 | trailing.py | duplicate scale_out engel |
| CR-0061 | Trailing Alias Reduction | done | 0001 | trailing.py | tekil trailing_update |
| CR-0062 | Offline Auto-Heal Persist Behavior | done | 0001 | core.py | success + missing_stop_tp korunumu |
| CR-0063 | OrderState FSM Implementation | done | 0001 | core.py,state_manager.py,order_state.py | FSM durum geçişleri entegrasyonu |
| CR-0066 | Schema Versioning v4 | done | 0001 | trade_store.py,rollback_schema_v4.py | created_ts,updated_ts,schema_version,rollback |
| CR-0067 | Reconciliation v2 | done | 0001 | core.py,test_reconciliation_v2.py | orderId mapping, partial fill sync, performance |
| CR-0064 | Lookahead Bias Prevention | done | 0001 | utils/lookahead_guard.py,signal_generator.py,tests/test_lookahead_guard.py | hysteresis current bar koruma |
| CR-0065 | Slippage Guard Protection | done | 0001 | utils/slippage_guard.py,execution.py,settings.py,tests/ | BUY/SELL slippage + ABORT/REDUCE policy |
| CR-0068 | Auto-heal Futures & SELL Expansion | done | 0001 | api/binance_api.py,trader/core.py,tests/test_cr0068_auto_heal_expansion.py | futures protection + SELL support |
| CR-0069 | Guard Events Persistence | done | 0001 | utils/guard_events.py,utils/trade_store.py,trader/core.py,trader/guards.py,tests/test_cr0069_guard_events_persistence.py | guard telemetry persistence layer |
| CR-0070 | Threshold Overrides Caching | done | 0001 | utils/threshold_cache.py,signal_generator.py,indicators.py,main.py,tests/test_cr0070_threshold_cache.py | O(1) threshold lookup + override management |
| CR-0071 | Config Snapshot Hash Persist | done | 0001 | utils/config_snapshot.py,trader/core.py,tests/test_cr0071_config_snapshot.py | Deterministic config state tracking + hash-based change detection |
| CR-0072 | Determinism Replay Harness | done | 0001 | utils/replay_manager.py,scripts/cr0072_integration.py,tests/test_cr0072_replay_manager.py | Trade decision replay with session recording, deterministic verification, config snapshot integration |
| CR-0073 | Headless Runner & Degrade Mode | done | 0001 | src/headless_runner.py,tests/test_cr0073_headless_runner.py,run_headless.bat,run_headless.sh | CLI headless operation, signal handling, component health monitoring, graceful shutdown, daemon mode, environment validation, 25 tests PASS |
| CR-0074 | Structured Logging Schema Validation | done | 0001 | src/utils/structured_log.py,tests/test_cr0074_structured_logging.py | Schema validation, performance monitoring, error tracking, JSON output format compliance, 18 tests PASS |
| CR-0075 | Prometheus Metrics Integration | done | 0001 | src/utils/prometheus_metrics.py,src/trader/core.py,tests/test_cr0075_prometheus.py | HTTP metrics endpoint, trade counters, latency histograms, error rates, 15 tests PASS |
| CR-0076 | Unified Risk Escalation System | done | 0001 | src/utils/risk_escalation.py,src/trader/core.py,tests/test_cr0076_integration.py,manual_test_cr0076.py | Progressive risk levels (NORMAL/WARNING/CRITICAL/EMERGENCY), unified kill-switch, automatic risk reduction, 22 tests PASS |
| CR-UI-INTEGRATION | UI System Integration | done | 0001 | src/ui/main_window.py,test_ui_system_status.py,CR-UI-INTEGRATION_COMPLETION_REPORT.md | Complete M4 milestone UI integration: Risk escalation status, Prometheus metrics, system health monitoring, config snapshots management, real-time updates |
| CR-UI-LOCALIZATION | Turkish UI Localization | done | 0001 | src/ui/main_window.py | Comprehensive Turkish translation of UI components: All tabs (Sistem, Yapılandırma Anlık Görüntü, Kapalı, Sinyaller), menu bar (Dosya, Görünüm, Araçlar, Yardım), dialogs, status messages, risk escalation levels (NORMAL/UYARI/KRİTİK/ACİL DURUM), fully functional Turkish interface |
| CR-UI-ASYNC-BACKTEST | UI Async Backtest & Calibration | done | 0001 | src/ui/main_window.py | Backtest/kalibrasyon arka plan thread'lerine taşındı, ilerleme göstergesi ve güvenli buton durum yönetimi eklendi; UI freeze giderildi |
| CR-UI-FREEZE-FIX | UI Freeze & Status Loop Fix | done | 0001 | src/ui/main_window.py | Alt durum çubuğunda sürekli dönme/donma problemi giderildi; reentrancy guard ve QTimer tabanlı güncelleme |
| CR-UI-LINT-UNICODE | UI Unicode Lint Taming | done | 0001 | ruff.toml, src/ui/main_window.py | UI dosyası için RUF001/2/3 per-file ignore; Unicode uyarıları bastırıldı, üretim kodunda davranış değişikliği yok |
| CR-0082 | Incremental UI Table Updates | in-progress | 0001 | src/ui/main_window.py,CR-0082_INCREMENTAL_UI_UPDATE.md | Performance optimization: Incremental diff for UI tables instead of full repaint, helper function implemented, positions/closed/scale-out table optimization |
| CR-0074 | Metrics Prometheus Export | done | 0001 | utils/prometheus_exporter.py,tests/test_cr0074_prometheus.py | Production monitoring, HTTP /metrics endpoint, thread-safe collection, 15+ metric definitions, Grafana dashboard support |
| CR-0075 | Structured Log JSON Schema Validation | done | 0001 | utils/structured_log_validator.py,src/utils/structured_log.py,test_cr0075_simple.py | 30+ event schema definitions, non-blocking validation, graceful degradation, statistics tracking, 6 tests PASS |
| CR-0076 | Risk Kill-Switch Escalation Unification | done | 0001 | src/utils/risk_escalation.py,src/trader/core.py,tests/test_cr0076_integration.py,manual_test_cr0076.py | Unified risk escalation system with progressive levels (NORMAL/WARNING/CRITICAL/EMERGENCY), coordinated kill-switch behavior, automatic risk reduction, structured logging integration, manual override capability |
| CR-0077 | Production Debug Cleanup | done | 0001 | src/trader/core.py | Debug print statements removed from production paths, test environment detection hardened, logger level validation added |
| CR-0078 | Exception Narrowing Final | done | 0001 | src/utils/trade_store.py,src/trader/core.py | Generic 'except Exception' replaced with specific exception types (sqlite3.Error, ValueError, TypeError, ImportError, AttributeError), improved error context preservation |
| CR-0080 | Core Complexity Reduction | done | 0001 | src/trader/core.py | __init__ method refactored from 23 to ~8 complexity via helper methods (_setup_test_environment, _sync_env_settings, _init_subsystems, _startup_maintenance), _recon_auto_heal split into mode-specific handlers |
| CR-0081 | Signal Generator Refactor | done | 0001 | src/signal_generator.py | generate_pair_signal refactored from 31 to ~12 complexity via pipeline pattern (_execute_signal_pipeline, _load_and_validate_data, _compute_indicators, _calculate_scores, _apply_hysteresis, _build_signal_data) |
| CR-UI-FIX | UI System Bug Fix & Enhancement | done | 0001 | src/ui/main_window.py | Comprehensive UI fixes: SignalGenerator integration, bot control menu, backtest tab, enhanced settings interface, theme improvements, QGroupBox import fix - All user-reported UI functionality issues resolved |
| CR-UI-RESPONSIVE | UI Responsive Enhancement | done | 0001 | src/ui/main_window.py | Window size optimization (1400x900), responsive table headers, alternating row colors, center window positioning, missing open_signal_window function implementation |
| CR-UI-DASHBOARD-PHASE1 | UI Dashboard Meta-Router Panel | done | 0001 | src/ui/meta_router_panel.py,src/ui/main_window.py,test_meta_router_panel.py,UI_DASHBOARD_PHASE1_COMPLETION_REPORT.md | Complete Meta-Router control panel: 4 specialist weight bars, gating status display, ensemble decision monitoring, real-time updates (500ms), enable/disable toggle, color-coded indicators, main UI tab integration, standalone/integrated testing passed |
| CR-STRATEGY-ADVANCED | Advanced Profitable Strategy Implementation | in-progress | 0001 | src/backtest/realistic_backtest.py,src/signal_generator.py,src/indicators.py | Multi-indicator confluence (RSI+MACD+Bollinger), dynamic ATR-based position sizing, 3:1 risk/reward ratio, cost optimization, 1.18% expectancy target vs 0.26% current, confluence scoring implemented |
| CR-STRATEGY-CONFLUENCE | Advanced Confluence Strategy Complete | done | 0001 | src/indicators.py,src/signal_generator.py,simple_realistic_test.py,test_confluence_performance.py,test_expectancy_optimization.py | Multi-indicator confluence (RSI+MACD+Bollinger), 75+ selectivity threshold, 1.010% expectancy achieved (vs 1.0% target), 210 trades/month (vs 40 target), 100% confluence rate, high-quality signal generation |
| CR-BACKTEST-COIN-DETAILS | Per-Coin Backtest Results | done | 0001 | src/ui/main_window.py | 10 coin detaylı analizi, confluence skorlama, renk kodlaması, kognitif karmaşıklık azaltma (24→8 helper metodlar), emoji sinyal gösterimi, kalite metrikleri (YUKSEK/ORTA/DUSUK), expected return hesaplama |
| CR-0086 | Clock Skew Guard & Metrics | done | 0001 | src/api/health_check.py,src/utils/prometheus_export.py,tests/test_clock_skew_guard.py | serverTime drift ölçümü, guard ve uyarı, Prometheus gauge/counter (bot_clock_skew_ms_gauge, bot_clock_skew_alerts_total), 2 tests PASS |
| CR-0084 | Rate Limit & Backoff Telemetry | done | 0001 | src/utils/prometheus_export.py,src/api/binance_api.py,tests/test_cr0084_rate_limit_telemetry.py | bot_rate_limit_hits_total{code}, bot_backoff_seconds histogramı, bot_used_weight_gauge; BinanceAPI 418/429 ve X-MBX-USED-WEIGHT enstrümantasyonu; testler PASS |
| CR-0079 | Precision & Filters Compliance | done | 0001 | src/api/binance_api.py,tests/test_cr0079_precision_filters.py | LOT_SIZE/PRICE_FILTER/MIN_NOTIONAL/NOTIONAL uyumu tek `quantize` fonksiyonunda; basit filtre cache (TTL 300s); spot/futures için minNotional altında qty=0 davranışı; 2 unit test PASS |
