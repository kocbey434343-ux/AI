== Yapılacaklar Listesi ==
KURAL: Bu dosyadaki her madde tamamlandığında madde (✓) ile işaretlenip dosyadan KALDIRILACAK ve tamamlanan iş için 'kayıt defteri.txt' dosyasına yeni numaralı bir giriş (tarih + ne + neden + kısa teknik not) eklenecek. Düzenli aralıklarla öncelikler güncellenecek.İş akışı olabildiğince onay istemeden otomatik devam edip tamamlanacak.
ÖNEM DERECELERİ: [P1]=kritik güvenilirlik/risk, [P2]=önemli değer, [P3]=iyileştirme.

-- A) Stabilite & Güvenilirlik --
[P1] PriceStream kapatılırken thread join başarısızsa zorla kes (timeout logging).
[P2] Ana zamanlayıcı hatalarında merkezi exception hook ve görsel uyarı (status çubuğu).
[P2] Graceful shutdown: uygulama kapanışında açık trade kayıt flush + son durum snapshot.
[P1] Backtest kalibrasyon uyumsuzluğu: UI winrate vs run_calibration trade_stats fark analizi (ADX filtresi, persisted thresholds, candidate baseline tekrarının doğrulanması) ve otomatik tutarlılık self-check logu.
[P1] Açık pozisyon / emir reconciliation (bakiye & open orders -> local state diff) (Yeni)
[P1] Günlük risk reset otomasyonu (yeni gün tespiti + halt flag temizleme + rapor) (Yeni)
[P1] Anomaly (latency/slippage) tetiklenince otomatik risk % düşürme veya trade durdurma (Yeni)
[P1] Kısmi fill kalan miktar için otomatik kalan emir yeniden ayarlama (Yeni)
[P1] Restart sonrası trailing & partial state tam persist (scaled_out + stop history) (Yeni)


-- B) Test Kapsamı --
[P2] update_positions PnL hesaplama testleri (LONG/SHORT yön farkı + edge cases).
[P2] _maybe_refresh_ws_symbols restart tetik testi (symbol fark senaryoları, debounce).
[P2] ATR trailing stop test (güncellenen stop DB'ye yansıyor mu?). (Kısmi: temel ATR trailing log testleri var, DB doğrulama eklenecek)
[P3] Calibration pipeline smoke test (önerilen eşikler üretimi). (Yeni)
[P3] Partial fill senaryosu deterministik test (simulate partial fills -> position & executions doğrulama). (Yeni)
[P3] OCO order offline stub testi (spot OFFLINE_MODE). (Yeni)


-- C) Performans Optimizasyonu --
[P1] update_positions incremental diff (tam tablo yeniden çizim azaltma).
[P2] Price update batching (GUI repaint frekansı sınırlama; örn 250ms throttle).
[P2] DB index denetimi (open_trades, executions üzerinde composite index öner).
[P3] Lazy signal satır clone yerine veri modeli + proxy (daha büyük setler için hazırlık).
[P2] Korelasyon hesap throttling (saniyede max N hesap) (Yeni)
[P2] Order book snapshot cache (slippage ölçümü için) (Yeni)

-- D) Özellik Geliştirme --
[P1] Toplam Unrealized PnL (USDT) göstergesi: Stil + test iyileştirme (hesaplama mevcut).
[P1] Global exposure metriği (sembol / sektör / yön dağılımı).
[P2] Parametre set yönetim UI (listele, etkinleştir, sil, açıklama).
[P2] Trailing stop görseli (pozisyon satırında SL kolon renklendirme değişimi).
[P2] Scale-out planı tanımlama (UI: hedef seviyeler + miktarlar).
[P3] Optimization candidates CSV/JSON export UI butonu.
[P3] Sinyal filtresi gelişmiş (ör: signal:AL score>70 vol>1e7).
[P2] Çoklu sembol hızlı arama (positions & signals tabloları için üstte incremental search kutusu). (Yeni UI)
[P2] Pozisyon detay yan paneli (seçilen pozisyonun ATR, partial history, trailing log gösterimi). (Yeni UI)
[P2] Gerçek zamanlı latency & slippage mini chart (Metrics sekmesi içi sparkline). (Yeni UI)
[P3] Drag & drop kolon yeniden sıralama + layout preset kaydetme. (Yeni UI)
[P3] Global tema switcher (Işık/Koyu + renk körlüğü dostu palet). (Yeni UI)
[P3] Parametre set diff görüntüleyici (iki param_set JSON farkı side-by-side). (Yeni UI)
[P3] Trade detay modal (execution listesi, scale-out zaman çizelgesi). (Yeni UI)
[P3] Inline edit: stop_loss / take_profit tablo hücresinden güncelleme. (Yeni UI)
[P3] Çoklu kapanış seçimi (checkbox ile birden fazla pozisyon kapat). (Yeni UI)
[P3] Klavye kısayolları (pozisyon seç, kapat, yenile). (Yeni UI)
[P3] Dinamik row highlight (son güncellenen fiyat veya stop değişikliği). (Yeni UI)
[P3] PnL heatmap (sembol bazlı ızgara görseli). (Yeni UI)
[P3] Gün içi performans timeline grafiği (equity curve incremental). (Yeni UI)
[P3] İşlem açılışı öncesi onay popup (opsiyonel, config kontrollü). (Yeni UI)
[P3] Genişletilebilir log konsolu (filtre: risk|order|ws|metric). (Yeni UI)
[P3] Sinyal kart görünümü (tablo yerine kart layout opsiyonu). (Yeni UI)
[P3] Çoklu dil altyapısı için i18n extractor script (UI). (Yeni UI)
[P3] UI performans profiler overlay (render süresi, FPS tahmini). (Yeni UI)
[P3] Snapshot export (ekran görüntüsü + JSON state paketleme). (Yeni UI)
[P3] Ayarlanabilir refresh interval slider (fiyat/sinyal çekme frekansı). (Yeni UI)
[P3] Kullanıcı tercihlerinin (tema, kolonlar) disk persist JSON dosyası. (Yeni UI)
[P3] Risk guard trigger counter badge (toolbar ikonu). (Yeni UI)
[P3] Anlık korelasyon matrisi mini dialog (aktif pozisyonlar). (Yeni UI)
[P3] ATR band overlay (chart üzerinde). (Yeni UI)
[P3] Quick trade panel (manuel sembol+qty+side hızlı giriş). (Yeni UI)
[P3] Tooltips optimizasyonu (gecikme, HTML format). (Yeni UI)
[P3] Responsive pencere küçülünce sekmeli kompakt mod. (Yeni UI)
[P3] Offline mode banner (üst çubukta). (Yeni UI)
[P3] Execution listesi canlı akış (yeni satırlar fade-in). (Yeni UI)
[P3] Partial exit progress bar (pozisyon satırında). (Yeni UI)
[P3] Trailing stop hareket animasyonu (eski->yeni SL). (Yeni UI)
[P3] Komut paleti (Ctrl+K ile aksiyon arama). (Yeni UI)
[P3] Otomatik güncelleme uyarı balonu (yeni sürüm tespiti). (Yeni UI)
[P3] Hata rapor gönder butonu (log paketleyip kullanıcıya konum). (Yeni UI)
[P3] Masaüstü bildirimleri (işlem aç/kapa). (Yeni UI)
[P3] WebSocket durum ikonu (renk + tooltip). (Yeni UI)
[P3] Sürükle bırak param_set.json yükleme alanı. (Yeni UI)
[P3] Çift tık ile grafikte sembol açma (entegre chart stub). (Yeni UI)
[P3] Sinyal skor dağılım histogramı. (Yeni UI)
[P3] PnL dağılım violin/box plot. (Yeni UI)
[P3] Ölçeklenebilir font boyutu ayarı (erişilebilirlik). (Yeni UI)
[P3] High contrast modu. (Yeni UI)
[P3] UI state diff viewer (önce/sonra debug). (Yeni UI)
[P3] Thread/Task monitor paneli. (Yeni UI)
[P3] DB health göstergesi (boyut, vacuum önerisi). (Yeni UI)
[P3] Session süre sayacı (başlangıçtan beri). (Yeni UI)
[P3] Giriş formu risk özet hesap (expected loss, R-multiple göstergesi). (Yeni UI)
[P3] Esnek sütun gizleme/gösterme menüsü. (Yeni UI)
[P3] Scroll konumu persist (yeniden açınca). (Yeni UI)
[P3] Kompakt mod toggle (daha yoğun tablo). (Yeni UI)

-- E) İzlenebilirlik & Gözlemleme --
[P1] Metrics sekmesi: latency, slippage, trailing, risk guard tetik sayısı (record_metric tabanı hazır, UI entegrasyonu pending).
[P2] Yapısal JSON logging opsiyonu (config ile aç/kapat).
[P2] Websocket hata sayacı + otomatik reset.
[P3] Runtime config snapshot (her X saatte bir).


-- F) Konfigürasyon & Parametreler --
[P2] Debounce süresi (şu an sabit 2s) Settings üzerinden yönetilebilir.
[P2] WS sembol üst limiti (40) konfigürasyona taşınacak.
[P2] ATR trailing parametreleri (multiplier, min move) UI üzerinden ayarlanabilir.
[P3] Outlier threshold UI kontrolü.

-- G) Kullanıcı Deneyimi --
[P2] Pozisyon tabloda kolon sıralama & kalıcı genişlik persist (session restore).
[P2] Dark mode stil revizyonu (kontrast / kırmızı-yeşil erişilebilirlik).
[P3] Dil seçimi (TR/EN toggle) - metin sabitleri için kaynak dosya.

-- H) Risk & Trade Mantığı --
[P1] Position sizing formülü gözden geçirme (volatilite ayarlı risk / ATR).
[P2] Korelasyon cache penceresi (en çok korele açık listesi).
[P2] Trailing stop + partial exit strateji parametre optimizasyonu (backtest entegrasyonu).
[P3] Zaman bazlı kademeli scale-out (bar sayısına göre).
[P1] Gün içi kademeli risk azaltma (drawdown bantlarına göre risk_percent düşür) (Yeni)
[P2] Dynamic correlation threshold (yüksek volatilitede gevşet) (Yeni)
[P2] Volatiliteye göre max eşzamanlı pozisyon adaptasyonu (Yeni)

-- I) Veri Kalitesi --
[P1] DataFetcher stale veri tespiti (timestamp drift) ve uyarı.
[P2] Retry/backoff telemetry (kaç deneme, toplam gecikme).
[P3] Local data integrity check (CSV kolon sayısı, NaN oranı) raporu.

-- J) Deployment / Operasyon --
[P2] requirements.txt hash lock (pip-tools veya uv pip compile).
[P2] Basit paketleme script (pyinstaller veya zip release).
[P3] CI pipeline (lint + tests) - GitHub Actions workflow.

-- K) Dokümantasyon --
[P2] README güncelle: yeni risk özellikleri, trailing, correlation, canlı fiyat.
[P2] Geliştirici rehberi: yeni gösterge ekleme adımları.
[P3] Kullanıcı kılavuzu (GUI sekmeleri açıklama).
[P3] Test kapsamı rehberi (risk, partial, trailing, correlation senaryoları). (Yeni)

-- L) Refactor / Temizlik --
[P2] main_window.py bölümlendirme (positions, calibration, signals alt modüllere ayrım).
[P2] Signal table clone logic -> model/view pattern adaptasyonu.
[P3] PriceStreamManager test doubles + arayüz (interface) soyutlama.

-- M) Güvenlik / Dayanıklılık --
[P1] API key sızıntı kontrolü (dotenv var, ama runtime log satırlarını tarama).
[P2] Rate limit hit dedektörü ve otomatik uyku.
[P3] Basit circuit breaker (ardışık WS hatası > N).

== Öncelikli İlk Sprint Önerisi ==
1) (P1) WS sağlık denetimi + exponential backoff
2) (P1) Risk guard testleri
3) (P1) Weighted PnL & correlation guard testleri
4) (P1) update_positions incremental diff prototip
5) (P1) Toplam Unrealized PnL göstergesi

Not: Sprint sonunda kayıt defteri'ne tek satırlık özet + her madde için numaralı detay girilecek.
